# Issue 作成SOP（テンプレ厳守・詳細化・整合チェック）

このSOPは、Issue作成時の恒常的なズレを防ぐための実務手順です。以下を必ず満たしてください。

## 1. テンプレート厳守
次の見出しを削除・改変せず必ず含めます。
- # タイトル
- ## 概要
- ## 要件
- ## チェックリスト
- ## 重要事項
- ## 参考

自動チェック（CI）が本文内の見出しを検証するため、以下を必ず満たしてください。
- 本文先頭に `# タイトル` の見出しを置き、その直後にタイトルの本文行を記載してください。
- `# タイトル` のブロックと `## 概要` の間に空行を1行入れてください。

例（本文先頭）:
```
# タイトル
Issue のタイトルをここに記載する

## 概要
<目的/背景/達成したいこと>
```

（注）Issue の UI 上の「タイトル」フィールドにも同じタイトル文を設定してください。本文内の `# タイトル` 見出しが CI の検証対象です。

## 2. 詳細度の維持（要件の最低粒度）
## 要件 は以下の小項目を **サブ見出し（### 見出し）と箇条書きを組み合わせた階層構造** で具体化します。
- **### 機能仕様**: 挙動、フォールバック、境界ケースの規定（箇条書きで詳細化）
- **### UI/文言**: 選択肢・ヘルプ・プレースホルダー（箇条書きで詳細化）
- **### 互換性/移行**: 既存挙動、設定の切替、データ構造（箇条書きで詳細化）
- **### 実装影響範囲**: 編集が必要なファイル/層（箇条書きで詳細化）
- **### テスト観点**: 受け入れ基準の列挙（箇条書きで詳細化）

各サブ見出し配下では、**太字（`**項目名**`）と箇条書き（`-`）を組み合わせ**、複数行にわたる詳細説明を記載します。単なる1行箇条書きではなく、各項目に対して具体的な条件・挙動・制約を明記してください。

## 3. チェックリストの整合ルール
## チェックリスト は ## 要件 と1対1対応で作成します。各小項目に対して最低1チェック項目を用意し、表現を合わせます（例: 評価ロジック更新、互換モード設定の追加 など）。

## 4. 重要事項は固定
## 重要事項 はテンプレートの固定文をそのまま記述します（追加の注意は下に追記可）。

## 5. 参考は「固定＋案件固有」
## 参考 には次を必ず含めます。
- リポジトリ運用規約: .github/copilot-instructions.md
- 案件固有の参照（関連PR/Issue、設計ドキュメント等）
 - コメント主導レビューポリシー: .github/copilot-instructions.md の "コメント主導レビューポリシー" セクションを参照

## 6. 投稿上の記号・レイアウト制約
- 通常の改行のみ使用（\n）。\n\nの直書き禁止。
- Markdownコードブロック（```）内では、PHPの $ 記号やその他のプログラミング言語の特殊記号を使用可能。
- コードブロックは必ず言語指定（```php、```javascript等）を行い、閉じタグの欠落に注意。
- コードブロック外での $ の使用は避け、変数を説明する場合は「変数名」等のテキスト表現を使用。
- Issueやコメント投稿用に一時作成したファイル（例: `.github/issue-xxx.md` など）は、投稿完了後に必ず削除すること（ローカル/CIとも徹底）。

## 7. ひな形（コピーして編集）
以下をコピーして内容だけ編集してください。

<ここにタイトルを記載>

## 概要

<目的/背景/達成したいこと>

## 要件

### 機能仕様
- **主要機能A**
  - 条件A1: <詳細な条件>
  - 条件A2: <詳細な条件>
  - フォールバック: <フォールバック動作>
- **境界ケース**
  - ケースB1: <境界条件と挙動>
  - ケースB2: <境界条件と挙動>

### UI/文言
- **配置場所**
  - <管理画面/フロントのどこに配置するか>
- **入力要素**
  - <選択肢・入力欄の詳細>
  - ラベル: <表示文言>
  - ヘルプ: <説明文>
  - プレースホルダー: <入力例>
- **国際化対応**
  - すべてのラベル・説明文は __()/esc_html__ 等でラップ（テキストドメイン: novel-game-plugin）
  - languages/novel-game-plugin.pot を更新

### 互換性/移行
- **既存挙動の維持**
  - <既存機能への影響がないことを明記>
  - <データ移行が必要な場合はその手順>
- **設定の切替**
  - <新旧設定の切替方法>
  - <デフォルト値の扱い>

### 実装影響範囲
- **管理画面**
  - <該当ファイルと変更内容>
- **フロントエンド**
  - <該当ファイルと変更内容>
- **データ構造**
  - <post meta / option 等の追加・変更>
- **翻訳**
  - <pot/po/mo の更新>

### テスト観点
- **基本動作**
  - <正常系の受け入れ基準>
- **境界ケース**
  - <異常系・境界条件の検証項目>
- **権限・セキュリティ**
  - <権限チェック・nonce・サニタイズの確認>
- **互換性**
  - <既存機能の回帰がないことの確認>

## チェックリスト
- [ ] <機能仕様に対応する実装項目>
- [ ] <UI/文言の更新項目>
- [ ] <互換性/移行の作業項目>
- [ ] <実装影響範囲の作業項目>
- [ ] <テスト観点の検証項目>

## 重要事項
以下の運用ルールを遵守してください。
- /.github/copilot-instructions.md の指示に基づく運用を コメントによる追加修正時でも 徹底
- タイトルや概要、コメントはルールに則り 日本語 で投稿
- 一度作成したプルリクエストのタイトルや概要の内容を追加修正に伴って変更することは 絶対に行わない
- report_progress ツールの prDescription パラメータはプルリクエスト初回作成時のみ使用すること
- プルリクエストの機能追加、バグ修正に伴って正常動作している機能を損なわないように 細心の注意 を払う
- PR の base は必ず dev（master 直は不可）

## 参考
- リポジトリ運用規約: .github/copilot-instructions.md
- <関連PR/Issue/資料>
