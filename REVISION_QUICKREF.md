# リビジョン機能 - クイックリファレンス

## 概要
novel_game 投稿タイプでWordPress標準のリビジョン機能が利用可能になりました。

## 主な機能

### 自動リビジョン作成
- 投稿を保存するたびにリビジョンが自動作成されます
- すべてのカスタムメタデータ（背景、キャラクター、セリフ、選択肢など）が含まれます

### リビジョン比較
- 管理画面の「リビジョン」メタボックスからアクセス
- 異なるバージョン間の差分を視覚的に確認できます

### リビジョン復元
- 過去の任意のバージョンに簡単に戻せます
- すべてのカスタムメタデータも自動的に復元されます

## 使い方

### リビジョンを確認する
1. 投稿編集画面を開く
2. 画面右側の「リビジョン」メタボックスを確認
3. 「リビジョンを参照」をクリック

### リビジョンを復元する
1. リビジョン比較画面を開く
2. スライダーで復元したいバージョンを選択
3. 「このリビジョンを復元」ボタンをクリック

## 対応フィールド

すべてのカスタムメタフィールドがリビジョン対応：
- ✓ 背景画像
- ✓ キャラクター画像（左・中央・右）
- ✓ キャラクター名
- ✓ セリフテキスト
- ✓ セリフ話者
- ✓ セリフ背景
- ✓ セリフフラグ条件
- ✓ 選択肢
- ✓ ゲームタイトル
- ✓ エンディング設定
- ✓ シーン到達時フラグ

## 設定

### リビジョン数の制限
`wp-config.php` に以下を追加：
```php
// リビジョンを5個まで保持
define('WP_POST_REVISIONS', 5);

// リビジョン機能を無効化（非推奨）
define('WP_POST_REVISIONS', false);
```

### 自動保存の間隔
`wp-config.php` に以下を追加：
```php
// 自動保存を120秒（2分）ごとに実行
define('AUTOSAVE_INTERVAL', 120);
```

## トラブルシューティング

### リビジョンが表示されない
- WordPressのバージョンを確認（4.7以上が必要）
- `wp-config.php` で `WP_POST_REVISIONS` が `false` になっていないか確認

### 復元後にデータが正しくない
- ブラウザのキャッシュをクリア
- ページをリロード
- それでも問題が続く場合は、データベースを確認

## 詳細情報

- 実装詳細: [REVISION_IMPLEMENTATION.md](REVISION_IMPLEMENTATION.md)
- テストシナリオ: [REVISION_TEST_SCENARIOS.md](REVISION_TEST_SCENARIOS.md)

## 注意事項

1. **データベース容量**: リビジョンはデータベース容量を使用します。定期的な整理を推奨。
2. **パフォーマンス**: 大量のリビジョンがあると管理画面が重くなる可能性があります。
3. **バックアップ**: リビジョン機能はバックアップの代替にはなりません。定期的なバックアップを実施してください。
